<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>multi snake</title>
    <style>
        * { margin: 0; padding: 0;}

        body, html { height:100%; overflow: hidden;}

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            background: darkslategray;
        }

        #canvas {
            border: 1px solid cadetblue;
            background: black;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
</body>

<script>
    const colors = {
        background: 'black'
    }

    class Renderer {
        resolution = {
            width: 80,
            height: 60
        };
        client = {
            width: 640,
            height: 480,
        }

        pixel = {
            width: this.client.width / this.resolution.width,
            height: this.client.height / this.resolution.height
        }



        constructor() {
            const canvas = document.getElementById('canvas');
            canvas.width = this.client.width;
            canvas.height = this.client.height;

            this.ctx = canvas.getContext("2d");
        }


        drawPoint(x, y, color) {
            this.ctx.save();
            this.ctx.beginPath();

            this.ctx.fillStyle = color;
            this.ctx.strokeStyle = 'red';

            const topLeft = {
                x: x * this.pixel.width,
                y: y * this.pixel.height,
            }


            this.ctx.rect(topLeft.x, topLeft.y, this.pixel.height, this.pixel.width);

            this.ctx.fill();
            this.ctx.stroke();

            this.ctx.restore();
        }

        clear() {
            this.ctx.fillStyle = 'green';
            this.ctx.clearRect(0, 0, this.client.width, this.client.height)
        }
    }

    const Direction = {
        UP: 'up',
        DOWN: 'down',
        LEFT: 'left',
        RIGHT: 'right'
    }

    class Snake {
        color = 'white'
        direction = Direction.RIGHT;

        constructor(renderer, head) {
            this.renderer = renderer;
            this.body = [head];
            for (let i = 0; i < 5; i++) {
                this.body.push({x: head.x - i,y:  head.y})
            }

        }

        update() {
            const head = this.body[0];
            let newHead;

            switch (this.direction) {
                case Direction.RIGHT:
                    newHead = {x: head.x + 1, y: head.y}
                    break;
                case Direction.LEFT:
                    newHead = {x: head.x - 1, y: head.y}
                    break;
                case Direction.UP:
                    newHead = {x: head.x, y: head.y - 1}
                    break;
                case Direction.DOWN:
                    newHead = {x: head.x, y: head.y + 1}
                    break;
            }

            this.body.unshift(newHead)
            this.body.pop();
        }

        draw() {
            this.body.forEach(point => {
                this.renderer.drawPoint(point.x, point.y, this.color)
            })
        }
    }




    const renderer = new Renderer();

    const snake = new Snake(renderer, {x: 10, y: 10})

    const KeyCode = {
        ArrowUp: 'ArrowUp',
        ArrowDown: 'ArrowDown',
        ArrowRight: 'ArrowRight',
        ArrowLeft: 'ArrowLeft',
    }

    window.addEventListener("keydown", (event) => {
        switch (event.key) {
            case KeyCode.ArrowLeft:
                if (snake.direction !== Direction.RIGHT) {
                    snake.direction = Direction.LEFT;
                }
                break;
            case KeyCode.ArrowRight:
                if (snake.direction !== Direction.LEFT) {
                    snake.direction = Direction.RIGHT;
                }
                break;
            case KeyCode.ArrowUp:
                if (snake.direction !== Direction.DOWN) {
                    snake.direction = Direction.UP;
                }
                break;
            case KeyCode.ArrowDown:
                if (snake.direction !== Direction.UP) {
                    snake.direction = Direction.DOWN;
                }
                break;
        }
    });

    setInterval(() => {
        renderer.clear();
        snake.update();
        snake.draw();
    }, 500)


</script>

</html>